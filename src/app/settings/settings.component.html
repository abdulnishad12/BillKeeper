<div class="container">

	<div class="add-new-utility-holder">
		<button class="button"  (click)="openModal(addNewUtilityModal)">Add Utility</button>
	</div>

	<div class="utility-holder">
		<div class="row">
			<div class="col-12 col-lg-6 mb-5 animated zoomIn mx-auto" *ngFor="let utility of utilities;">
				<!-- Variable Price Utility -->
				<div class="utility-holder__item" *ngIf = "utility.fixedPaymentIndicator===false">
					<div class="utility-holder__header">
						<h3>{{utility.utilityName}}</h3>
						<button type="button" (click)="openModal(confirmDeleteUtility)">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>

					<div class="row">
						<div class="utility-holder__inputs col-12 col-sm-6 mb-2 mb-sm-0">

							<input type="number" class="form-control"
							(keyup) = "formValidationVariableCounter(utility.utilityName,counterAmount.value);"
							[ngClass]="{'invalid': validatorVariableCounter && selectedUtility===utility.utilityName }"
							placeholder="Previous Counter" #counterAmount>

							<div class="error"  [ngClass]="{ 'show': validatorVariableCounter && selectedUtility===utility.utilityName,'hide': !(validatorVariableCounter && selectedUtility===utility.utilityName) }">
								Only five-digit positive number allowed
							</div>

							<input type="number" class="form-control"
							(keyup) = "formValidationVariableTariff(utility.utilityName,tariffAmount.value);"
							[ngClass]="{'invalid': validatorVariableTariff && selectedUtility===utility.utilityName }"
							placeholder="Utility tariff" #tariffAmount>

							<div class="error" [ngClass]="{ 'show': validatorVariableTariff && selectedUtility===utility.utilityName,'hide': !(validatorVariableTariff && selectedUtility===utility.utilityName) }">
								Only five-digit positive number allowed
							</div>
						</div>
						<div class="utility-holder__data col-12 col-sm-6 mb-2 mb-sm-0">
							<div class="utility-holder__data--item">
								<p>Previous Counter: <span>{{utility.previousCounter}}</span></p>
							</div>
							<div class="utility-holder__data--item">
								<p>Tariff: <span>{{utility.tariff}}</span></p>
							</div>
						</div>
					</div>
					<button type ="submit" class="button"
					[ngClass]="{'cursor-off': validatorVariableTariff || validatorVariableCounter || counterAmount.value =='' || tariffAmount.value==''||  tariffAmount.value==0 }"
					(click) = "onSubmitNewTariff(utility.utilityName,utility.fixedPaymentIndicator,+counterAmount.value,+tariffAmount.value);tariffAmount.value='';counterAmount.value ='';">Submit</button>
				</div>

				<!-- Fixed Price Utility -->
				<div class="utility-holder__item" *ngIf = "utility.fixedPaymentIndicator===true">
					<div class="utility-holder__header">
						<h3>{{utility.utilityName}}</h3>
						<button type="button" (click)="openModal(confirmDeleteUtility)">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="row utility-holder-content ">
						<div class="utility-holder__inputs col-12 col-sm-6 mb-2 mb-sm-0">
							<input type="number" class="form-control" (keyup) = "formValidationFixed(utility.utilityName,tariffAmountFixed.value);" [ngClass]="{'invalid': validatorFixedTariff && selectedUtility === utility.utilityName }" placeholder="Fixed price" #tariffAmountFixed>
							<div class="error" [ngClass]="{ 'show': validatorFixedTariff && selectedUtility===utility.utilityName,'hide': !(validatorFixedTariff && selectedUtility===utility.utilityName) }">
								Only five-digit positive number allowed
							</div>
						</div>
						<div class="utility-holder__data col-12 col-sm-6 mb-2 mb-sm-0">
							<div class="utility-holder__data--item">
								<p>Fixed Amount: <span>{{utility.tariff}}</span></p>
							</div>
						</div>
					</div>
					<button class="button" [ngClass]="{'cursor-off': validatorFixedTariff || tariffAmountFixed.value =='' ||  tariffAmountFixed.value==0 }"  (click) = "onSubmitNewTariff(utility.utilityName,utility.fixedPaymentIndicator,previousCounter?.value,tariffAmountFixed.value);tariffAmountFixed.value = '';">Submit</button>
				</div>

				<ng-template #confirmDeleteUtility>
					<div class="modal-header">
						<h4 class="modal-title">Delete Confirmation</h4>
					</div>

					<div class="modal-body text-center">
						<p class="mb-3">Are you sure that you want to delete this utility:</p>
						<p class="strong">{{utility.utilityName}}</p>
						<button type="button" class="button" (click)="deleteUtility(utility.id);modalRef.hide();">Yes</button>
						<button type="button" class="button" (click)="modalRef.hide();">No</button>
					</div>
				</ng-template>


			</div>
		</div>
	</div>

	<ng-template #addNewUtilityModal>
		<div class="modal-header">
			<h4 class="modal-title pull-left">Add new utility</h4>
			<button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide();">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<div class="modal-body">
			<div class="modal-body__header">
				<span>Utility name:</span>

				<input [ngClass]="{'invalid': validatorNewUtility[0]}"
				placeholder="Enter utility Name"
				[(ngModel)]="newUtilityName" (keyup) = "formValidationNewUtility(newUtilityName);">

				<div class="error" [ngClass]="{ 'show': validatorNewUtility[0],'hide': !validatorNewUtility[0] }">
					{{validatorNewUtility[1]}}
				</div>
			</div>
			<div class="modal-body__inputs">
				<input  type="checkbox" id="checkbox_id" [(ngModel)]="newUtilityFixedPriceCheckbox">
				<label for="checkbox_id">Is it suppose to be fixed payment?</label>
			</div>
		</div>
		<div class="modal-footer">
			<button class="button" [ngClass]="{'cursor-off': validatorNewUtility[0] || newUtilityName =='' ||  newUtilityName==0 ||  newUtilityName==undefined }" (click) = "onSubmitNewUtility(newUtilityName,newUtilityFixedPriceCheckbox);newUtilityName = undefined;newFixedPrice = false;">Add</button>
		</div>
	</ng-template>




</div>





